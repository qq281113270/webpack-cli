// /*
//  * @Date: 2022-05-11 11:23:58
//  * @Author: Yao guan shou
//  * @LastEditors: Yao guan shou
//  * @LastEditTime: 2022-05-11 11:44:42
//  * @FilePath: /webpack-cli/delete_node_modules.js
//  * @Description:
//  */
var fs = require("fs");
var path = require("path");
const { readdirSync, stat } = fs;
var deleteFile = function (src, callbak) {
  let paths = readdirSync(src); //同步读取当前⽬录
  paths.forEach(function (path) {
    var _src = src + "/" + path;
    stat(_src, function (err, stats) {
      //stats 该对象包含⽂件属性
      if (err) {
        console.log('err===',err) 
         return 
      }
      if (stats.isFile()) {
        fs.unlink(_src, function(err){
          if(err){
            console.log('err===',err) 
            return 
          }
          console.log('文件:'+_src+'删除成功！');
         })
        
      } else if (stats.isDirectory()) {
        // callbak(_src, path, callbak);
        // fs.rmdir( path, options, callback )
        deleteFile(_src, callbak);
      }
    });
  });
};

deleteFile(
  path.join(process.cwd(), "/node_modules"), // 需要删除的文件夹
  (_src, path, callbak) => {
    // if (path == "node_modules") {
    //   // console.log("_src=", _src);
    //   rm(_src, () => {
    //     console.log("成功删除文件夹:", _src);
    //   });
    // } else {
    //   deleteFile(_src, callbak);
    // }
  }
);
